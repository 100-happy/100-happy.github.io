<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>관리자 페이지</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>모델 설정 관리자 페이지</h1>
        <form id="admin-form">
            <div class="form-group">
                <label for="model-url">모델 URL</label>
                <input type="text" class="form-control" id="model-url" placeholder="모델 URL을 입력하세요">
            </div>
            <div class="form-group">
                <label for="num-classes">분류 결과 개수</label>
                <input type="number" class="form-control" id="num-classes" placeholder="분류 결과 개수를 입력하세요">
            </div>
            <div id="class-details"></div>
            <button type="button" class="btn btn-primary" onclick="saveSettings()">저장</button>
        </form>

        <h2 class="mt-5">비밀번호 변경</h2>
        <form id="password-form">
            <div class="form-group">
                <label for="new-password">새 비밀번호</label>
                <input type="password" class="form-control" id="new-password" placeholder="새 비밀번호를 입력하세요">
            </div>
            <button type="button" class="btn btn-primary" onclick="changePassword()">비밀번호 변경</button>
        </form>
    </div>

    <div class="form-group">
        <label for="class-color-${i}">색상</label>
        <input type="color" class="form-control" id="class-color-${i}" value="#ffffff">
    </div>     
    
    <script>
        function generateClassInputs(numClasses) {
            const classDetails = document.getElementById('class-details');
            classDetails.innerHTML = '';
            for (let i = 0; i < numClasses; i++) {
                const classDetail = document.createElement('div');
                classDetail.classList.add('form-group');
                classDetail.innerHTML = `
                    <label for="class-name-${i}">분류 결과 ${i + 1} 이름</label>
                    <input type="text" class="form-control" id="class-name-${i}" placeholder="분류 결과 이름을 입력하세요">
                    <label for="class-title-${i}">Title</label>
                    <input type="text" class="form-control" id="class-title-${i}" placeholder="Title을 입력하세요">
                    <label for="class-explain-${i}">설명</label>
                    <input type="text" class="form-control" id="class-explain-${i}" placeholder="설명을 입력하세요">
                    <label for="class-celeb-${i}">유명인</label>
                    <input type="text" class="form-control" id="class-celeb-${i}" placeholder="유명인을 입력하세요">
                `;
                classDetails.appendChild(classDetail);
            }
        }

        document.getElementById('num-classes').addEventListener('change', function () {
            generateClassInputs(this.value);
        });

        function saveSettings() {
            const modelUrl = document.getElementById('model-url').value;
            const numClasses = document.getElementById('num-classes').value;
            const classDetails = [];
        
            for (let i = 0; i < numClasses; i++) {
                classDetails.push({
                    name: document.getElementById(`class-name-${i}`).value,
                    title: document.getElementById(`class-title-${i}`).value,
                    explain: document.getElementById(`class-explain-${i}`).value,
                    celeb: document.getElementById(`class-celeb-${i}`).value,
                    color: document.getElementById(`class-color-${i}`).value
                });
            }
        
            const settings = {
                modelUrl,
                numClasses,
                classDetails,
            };
        
            localStorage.setItem('modelSettings', JSON.stringify(settings));
            alert('설정이 저장되었습니다.');
        }

        function changePassword() {
            const newPassword = document.getElementById('new-password').value;
            if (newPassword) {
                localStorage.setItem('adminPassword', newPassword);
                alert('비밀번호가 변경되었습니다.');
            } else {
                alert('새 비밀번호를 입력하세요.');
            }
        }

        // 페이지 로드 시 기존 설정을 폼에 반영
        window.onload = function() {
            const settings = JSON.parse(localStorage.getItem('modelSettings'));
            if (settings) {
                document.getElementById('model-url').value = settings.modelUrl;
                document.getElementById('num-classes').value = settings.numClasses;
                generateClassInputs(settings.numClasses);
                settings.classDetails.forEach((detail, index) => {
                    document.getElementById(`class-name-${index}`).value = detail.name;
                    document.getElementById(`class-title-${index}`).value = detail.title;
                    document.getElementById(`class-explain-${index}`).value = detail.explain;
                    document.getElementById(`class-celeb-${index}`).value = detail.celeb;
                });
            }
        };
    </script>
</body>
</html>
